-- 上海市旅游景点导游系统数据库设计
-- 创建数据库
CREATE DATABASE IF NOT EXISTS shanghai_tourism CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE shanghai_tourism;

-- 1. 景点类型表
CREATE TABLE attraction_types (
    id INT PRIMARY KEY AUTO_INCREMENT,
    type_name VARCHAR(50) NOT NULL COMMENT '景点类型名称',
    description VARCHAR(200) COMMENT '类型描述'
);

-- 2. 景点信息表
CREATE TABLE attractions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL COMMENT '景点名称',
    english_name VARCHAR(100) COMMENT '英文名称',
    description TEXT COMMENT '景点简介',
    detailed_info TEXT COMMENT '详细介绍',
    price DECIMAL(10,2) DEFAULT 0 COMMENT '门票价格(元)',
    opening_hours VARCHAR(100) COMMENT '开放时间',
    max_capacity INT DEFAULT 10000 COMMENT '最大人流量',
    latitude DECIMAL(10,8) NOT NULL COMMENT '纬度',
    longitude DECIMAL(11,8) NOT NULL COMMENT '经度',
    type_id INT COMMENT '景点类型ID',
    district VARCHAR(50) COMMENT '所在区域',
    address VARCHAR(200) COMMENT '详细地址',
    phone VARCHAR(20) COMMENT '联系电话',
    website VARCHAR(200) COMMENT '官方网站',
    recommend_duration INT DEFAULT 120 COMMENT '推荐游览时长(分钟)',
    rating DECIMAL(3,1) DEFAULT 4.5 COMMENT '评分(1-5)',
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (type_id) REFERENCES attraction_types(id),
    INDEX idx_location (latitude, longitude),
    INDEX idx_type (type_id),
    INDEX idx_district (district)
);

-- 3. 交通工具表
CREATE TABLE transport_types (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL COMMENT '交通工具名称',
    speed_kmh DECIMAL(5,2) COMMENT '平均速度(公里/小时)',
    cost_per_km DECIMAL(8,2) COMMENT '每公里费用(元)'
);

-- 4. 景点间路径表
CREATE TABLE attraction_paths (
    id INT PRIMARY KEY AUTO_INCREMENT,
    from_attraction_id INT NOT NULL COMMENT '起点景点ID',
    to_attraction_id INT NOT NULL COMMENT '终点景点ID',
    distance_km DECIMAL(8,2) NOT NULL COMMENT '距离(公里)',
    transport_type_id INT NOT NULL COMMENT '交通工具ID',
    travel_time_minutes INT COMMENT '预估时间(分钟)',
    cost DECIMAL(10,2) COMMENT '费用(元)',
    description VARCHAR(200) COMMENT '路径描述',
    FOREIGN KEY (from_attraction_id) REFERENCES attractions(id),
    FOREIGN KEY (to_attraction_id) REFERENCES attractions(id),
    FOREIGN KEY (transport_type_id) REFERENCES transport_types(id),
    INDEX idx_from_to (from_attraction_id, to_attraction_id),
    INDEX idx_transport (transport_type_id)
);

-- 5. 游客类型表
CREATE TABLE visitor_types (
    id INT PRIMARY KEY AUTO_INCREMENT,
    type_name VARCHAR(50) NOT NULL COMMENT '游客类型',
    description VARCHAR(200) COMMENT '类型描述'
);

-- 6. 景点推荐表(根据游客类型)
CREATE TABLE attraction_recommendations (
    id INT PRIMARY KEY AUTO_INCREMENT,
    attraction_id INT NOT NULL,
    visitor_type_id INT NOT NULL,
    recommendation_score INT DEFAULT 5 COMMENT '推荐指数(1-10)',
    reason VARCHAR(200) COMMENT '推荐理由',
    FOREIGN KEY (attraction_id) REFERENCES attractions(id),
    FOREIGN KEY (visitor_type_id) REFERENCES visitor_types(id)
);

-- 插入景点类型数据
INSERT INTO attraction_types (type_name, description) VALUES
('历史文化', '具有深厚历史文化底蕴的景点'),
('现代建筑', '现代化建筑和城市景观'),
('自然风光', '自然景观和公园绿地'),
('购物娱乐', '购物中心和娱乐场所'),
('博物馆', '博物馆和展览馆'),
('主题乐园', '游乐园和主题公园'),
('古镇水乡', '传统古镇和水乡风貌'),
('宗教建筑', '寺庙和宗教场所'),
('科技体验', '科技馆和体验中心'),
('美食街区', '特色美食聚集地');

-- 插入交通工具数据
INSERT INTO transport_types (name, speed_kmh, cost_per_km) VALUES
('步行', 5.0, 0),
('地铁', 35.0, 0.5),
('公交车', 20.0, 0.3),
('出租车', 25.0, 2.5),
('网约车', 28.0, 2.0),
('共享单车', 15.0, 0.1);

-- 插入游客类型数据
INSERT INTO visitor_types (type_name, description) VALUES
('年轻情侣', '年轻情侣，喜欢浪漫和时尚的地方'),
('亲子家庭', '带小孩的家庭，注重安全和教育意义'),
('商务人士', '商务出行，时间有限，偏好高效游览'),
('老年游客', '老年人群，偏好舒适和文化景点'),
('学生群体', '学生，预算有限，喜欢性价比高的景点'),
('摄影爱好者', '摄影爱好者，寻找美景和特色建筑'),
('历史文化爱好者', '对历史文化感兴趣的游客'),
('购物达人', '喜欢购物和时尚的游客');

-- 插入上海著名景点数据
INSERT INTO attractions (name, english_name, description, detailed_info, price, opening_hours, max_capacity, latitude, longitude, type_id, district, address, phone, website, recommend_duration, rating) VALUES

-- 黄浦区景点
('外滩', 'The Bund', '上海最著名的滨江景观带，万国建筑博览群', '外滩位于黄浦江西岸，全长1.5公里，是上海最具标志性的景观。这里汇集了52幢风格各异的古典复兴建筑，被誉为"万国建筑博览群"。夜晚时分，两岸灯火辉煌，是观赏浦江夜景的最佳地点。', 0, '全天开放', 50000, 31.23389, 121.49188, 2, '黄浦区', '中山东一路', '021-63239999', 'http://www.thebund.com', 90, 4.8),

('南京路步行街', 'Nanjing Road Pedestrian Street', '中华商业第一街，购物天堂', '南京路步行街西起西藏中路，东至河南中路，全长1033米，是世界上最著名的商业街之一。这里汇集了众多百年老店和现代商场，是购物、美食、娱乐的绝佳去处。', 0, '全天开放', 100000, 31.23472, 121.47750, 4, '黄浦区', '南京东路', '021-63226888', NULL, 120, 4.6),

('豫园', 'Yuyuan Garden', '明代古典园林，江南园林艺术珍品', '豫园始建于明嘉靖年间，是上海著名的古典园林。园内楼阁参差，山石峥嵘，湖光潋滟，素有"城市山林"之誉。豫园商城内汇集了众多上海老字号商店和特色小吃。', 40, '8:30-17:00', 15000, 31.22646, 121.49131, 1, '黄浦区', '安仁街218号', '021-63260830', 'http://www.yuyuangarden.com', 120, 4.5),

('城隍庙', 'City God Temple', '上海著名道观，香火鼎盛', '上海城隍庙始建于明代，是上海地区重要的道教宫观。庙内供奉城隍神，香火旺盛。周边的城隍庙商圈是品尝上海小吃的好去处。', 10, '7:00-16:00', 8000, 31.22589, 121.49251, 8, '黄浦区', '方浜中路249号', '021-63284494', NULL, 60, 4.3),

('上海博物馆', 'Shanghai Museum', '中国古代艺术博物馆', '上海博物馆是一座大型的中国古代艺术博物馆，馆藏珍贵文物12万余件。建筑造型寓意"天圆地方"，设有青铜器、陶瓷器、书法、绘画等11个专馆。', 0, '9:00-17:00(周一闭馆)', 8000, 31.22859, 121.47570, 5, '黄浦区', '人民大道201号', '021-63723500', 'http://www.shanghaimuseum.net', 180, 4.7),

('人民广场', 'People\'s Square', '上海政治文化中心', '人民广场是上海的政治文化中心，广场中央有大型音乐喷泉。周边聚集了上海博物馆、上海大剧院、上海城市规划展示馆等重要文化设施。', 0, '全天开放', 30000, 31.22773, 121.47611, 2, '黄浦区', '人民大道', NULL, NULL, 60, 4.4),

-- 浦东新区景点
('东方明珠', 'Oriental Pearl Tower', '上海标志性建筑，全球第三高塔', '东方明珠广播电视塔高468米，是上海的标志性建筑。塔内设有太空舱、旋转餐厅、上海历史发展陈列馆等设施。登塔可俯瞰上海全貌，是游客必到之处。', 180, '8:00-21:30', 15000, 31.23953, 121.49954, 2, '浦东新区', '世纪大道1号', '021-58791888', 'http://www.orientalpearltv.com', 120, 4.6),

('上海中心大厦', 'Shanghai Tower', '中国第一高楼，世界第二高楼', '上海中心大厦总高度632米，是目前中国第一、世界第二高的摩天大楼。118层观光厅是世界最高的观光平台，可360度俯瞰上海全景。', 180, '8:30-22:00', 3000, 31.23350, 121.50560, 2, '浦东新区', '银城中路501号', '021-20206888', 'http://www.shanghaitower.com', 90, 4.8),

('金茂大厦', 'Jinmao Tower', '中国传统建筑风格的现代摩天大楼', '金茂大厦高420.5米，是上海首座超高层建筑。88层观光厅可欣赏黄浦江两岸美景，53-87层为君悦大酒店，1-50层为办公区域。', 120, '8:30-21:30', 2000, 31.23455, 121.50645, 2, '浦东新区', '世纪大道88号', '021-50491234', NULL, 90, 4.5),

('上海科技馆', 'Shanghai Science and Technology Museum', '大型科技博物馆', '上海科技馆占地面积6.8万平方米，以"自然、人、科技"为主题。设有生物万象、地球家园、智慧之光等11个常设展厅，是青少年科普教育的重要基地。', 60, '9:00-17:15(周一闭馆)', 15000, 31.22194, 121.54250, 9, '浦东新区', '世纪大道2000号', '021-68542000', 'http://www.sstm.org.cn', 180, 4.6),

('上海野生动物园', 'Shanghai Wild Animal Park', '中国首座国家级野生动物园', '上海野生动物园是中国首座国家级野生动物园，园内汇集了世界各地的珍稀动物200多种。分为车入区和步行区，可近距离观赏野生动物。', 130, '8:00-17:00', 20000, 31.07139, 121.67028, 6, '浦东新区', '南六公路178号', '021-61180000', 'http://www.shwzoo.com', 240, 4.4),

('上海迪士尼乐园', 'Shanghai Disneyland', '中国大陆首座迪士尼主题乐园', '上海迪士尼乐园是中国大陆第一个迪士尼主题乐园，拥有七大主题园区。结合了经典迪士尼故事和中国文化元素，为游客带来前所未有的神奇体验。', 399, '9:00-21:00', 80000, 31.14350, 121.66083, 6, '浦东新区', '川沙镇黄赵路310号', '400-180-0000', 'http://www.shanghaidisneyresort.com', 480, 4.7),

-- 静安区景点
('静安寺', 'Jing\'an Temple', '上海著名佛教寺院', '静安寺始建于三国孙吴时期，是上海最古老的佛寺之一。寺内供奉释迦牟尼佛，香火旺盛。寺院建筑金碧辉煌，与周围现代化高楼形成强烈对比。', 30, '7:30-17:00', 5000, 31.22667, 121.44472, 8, '静安区', '南京西路1686号', '021-62566366', NULL, 60, 4.3),

('静安雕塑公园', 'Jing\'an Sculpture Park', '城市中心的艺术绿洲', '静安雕塑公园是上海市中心最大的开放式城市公园，园内展示着众多国内外艺术家的雕塑作品。公园绿树成荫，是市民休闲的好去处。', 0, '5:00-18:00', 10000, 31.22056, 121.44722, 3, '静安区', '石门二路128号', '021-62533318', NULL, 90, 4.2),

-- 徐汇区景点
('徐家汇天主教堂', 'Xujiahui Cathedral', '哥特式天主教堂', '徐家汇天主教堂是上海最大的天主教堂，建于1910年。教堂采用哥特式建筑风格，红砖外墙，尖塔高耸，是上海重要的宗教建筑和历史文化遗产。', 0, '13:30-16:00', 2000, 31.19194, 121.43778, 8, '徐汇区', '蒲西路158号', '021-64692595', NULL, 45, 4.4),

('上海植物园', 'Shanghai Botanical Garden', '城市绿肺，植物科普基地', '上海植物园是一个以植物引种驯化和展示、园艺研究及科普教育为主的综合性植物园。园内收集栽培了9000余种植物，是上海市民休闲度假的好去处。', 15, '7:00-17:00', 15000, 31.15556, 121.43861, 3, '徐汇区', '龙吴路1111号', '021-54363369', 'http://www.shbg.org', 150, 4.3),

-- 长宁区景点
('中山公园', 'Zhongshan Park', '历史悠久的综合性公园', '中山公园始建于1914年，是上海历史最悠久的公园之一。园内古木参天，湖光山色，设有儿童乐园、动物园等设施，是市民休闲娱乐的好去处。', 3, '5:00-18:00', 12000, 31.22222, 121.42167, 3, '长宁区', '长宁路780号', '021-62521880', NULL, 90, 4.1),

-- 普陀区景点
('长风公园', 'Changfeng Park', '以海洋世界著称的主题公园', '长风公园是一座大型综合性公园，园内有上海海洋水族馆分馆——长风海洋世界。公园湖光山色，绿树成荫，是休闲娱乐的理想场所。', 30, '6:00-18:00', 15000, 31.24444, 121.42139, 3, '普陀区', '大渡河路451号', '021-62459775', NULL, 120, 4.2),

-- 虹口区景点
('鲁迅公园', 'Lu Xun Park', '纪念鲁迅先生的主题公园', '鲁迅公园原名虹口公园，为纪念鲁迅先生而更名。园内有鲁迅墓、鲁迅纪念馆，环境幽雅，是进行爱国主义教育的重要场所。', 0, '5:00-18:00', 8000, 31.26500, 121.49028, 3, '虹口区', '四川北路2288号', '021-65407888', NULL, 90, 4.0),

-- 杨浦区景点
('共青森林公园', 'Gongqing Forest Park', '上海最大的森林公园', '共青森林公园是上海最大的以森林为主要景观的特色公园。园内森林覆盖率高，空气清新，设有烧烤区、游乐设施等，是户外活动的好去处。', 15, '6:00-17:00', 20000, 31.31944, 121.55833, 3, '杨浦区', '军工路2000号', '021-65574830', NULL, 180, 4.1),

-- 闵行区景点
('七宝古镇', 'Qibao Ancient Town', '典型的江南古镇', '七宝古镇是距离上海市区最近的古镇，有着1000多年历史。古镇内小桥流水，古色古香，汇集了众多传统小吃和手工艺品，是体验江南水乡风情的好去处。', 45, '8:30-20:30', 25000, 31.15278, 121.35194, 7, '闵行区', '七宝镇新街', '021-54868588', NULL, 150, 4.3),

-- 青浦区景点
('朱家角古镇', 'Zhujiajiao Ancient Town', '上海威尼斯', '朱家角古镇是上海保存最完整的江南水乡古镇，有"上海威尼斯"之称。古镇内河道纵横，古桥众多，明清建筑随处可见，是感受江南水乡文化的绝佳之地。', 80, '8:30-16:30', 30000, 31.11194, 121.04917, 7, '青浦区', '朱家角镇美周路36号', '021-59240077', 'http://www.zhujiajiao.com', 180, 4.5),

-- 嘉定区景点
('汇龙潭公园', 'Huilongtan Park', '明代古典园林', '汇龙潭公园是嘉定区最大的古典园林，始建于明万历年间。园内亭台楼阁错落有致，假山池塘相映成趣，是典型的江南园林风格。', 5, '6:00-17:30', 5000, 31.37528, 121.26056, 1, '嘉定区', '塔城路299号', '021-59533505', NULL, 90, 4.0),

-- 松江区景点
('佘山国家森林公园', 'Sheshan National Forest Park', '上海之巅，天然氧吧', '佘山是上海的最高峰，海拔99米。山上古木参天，空气清新，有佘山天主教堂、月湖雕塑公园等景点。是上海市民登高望远、健身休闲的好去处。', 10, '8:00-16:00', 10000, 31.09722, 121.17889, 3, '松江区', '佘山镇外青松公路9142号', '021-57657775', NULL, 120, 4.2),

-- 奉贤区景点
('海湾国家森林公园', 'Haiwan National Forest Park', '滨海森林公园', '海湾国家森林公园是上海最大的人工森林，紧邻杭州湾。园内森林茂密，还有5.3公里的海岸线，是观海看日出的好地方。', 80, '8:00-17:00', 15000, 30.83333, 121.56667, 3, '奉贤区', '海湾镇随塘河路1677号', '021-57122000', NULL, 180, 4.1),

-- 崇明区景点
('东平国家森林公园', 'Dongping National Forest Park', '华东地区最大的平原人工森林', '东平国家森林公园是华东地区最大的平原人工森林，总面积5400亩。园内林木茂盛，野生动物众多，是崇明生态旅游的重要景点。', 70, '8:00-16:00', 8000, 31.45833, 121.63333, 3, '崇明区', '北沿公路2188号', '021-59338028', NULL, 240, 4.0),

-- 创意园区和新兴景点
('田子坊', 'Tianzifang', '创意产业聚集区', '田子坊是上海最有味道的弄堂，汇集了众多创意工作室、特色商店和咖啡馆。这里保留了老上海石库门的风貌，是体验上海文化创意产业的窗口。', 0, '10:00-22:00', 20000, 31.20861, 121.46639, 4, '黄浦区', '泰康路210弄', '021-64666518', NULL, 120, 4.4),

('新天地', 'Xintiandi', '时尚生活中心', '新天地是以石库门建筑为基础改造的时尚、休闲、文化、娱乐中心。这里汇集了众多国际品牌、高档餐厅和酒吧，是上海夜生活的重要场所。', 0, '全天开放', 25000, 31.22306, 121.47417, 4, '黄浦区', '太仓路181弄', '021-63119999', 'http://www.xintiandi.com', 150, 4.5),

('1933老场坊', '1933 Old Millfun', '创意地标建筑', '1933老场坊原为上海工部局宰牲场，现改造为创意产业园区。建筑风格独特，融合了装饰艺术风格和现代主义建筑理念，是摄影爱好者的热门地点。', 0, '10:00-22:00', 8000, 31.24583, 121.49139, 2, '虹口区', '沙泾路10号', '021-68716988', 'http://www.1933shanghai.com', 90, 4.3),

('M50创意园', 'M50 Creative Park', '艺术创意园区', 'M50创意园是上海重要的当代艺术园区，汇集了众多艺术家工作室、画廊和创意企业。园区内经常举办各种艺术展览和文化活动。', 0, '10:00-18:00', 3000, 31.24722, 121.44583, 5, '普陀区', '莫干山路50号', '021-62770337', 'http://www.m50.com.cn', 120, 4.2);

-- 插入景点推荐数据（基于游客类型的个性化推荐）
INSERT INTO attraction_recommendations (attraction_id, visitor_type_id, recommendation_score, reason) VALUES
-- 年轻情侣推荐
(1, 1, 10, '外滩夜景最浪漫，适合情侣漫步'),
(7, 1, 9, '东方明珠登高望远，浪漫约会圣地'),
(27, 1, 9, '新天地时尚浪漫，适合情侣逛街用餐'),
(26, 1, 8, '田子坊文艺小资，拍照圣地'),

-- 亲子家庭推荐
(10, 2, 10, '科技馆寓教于乐，适合亲子游'),
(11, 2, 9, '野生动物园近距离接触动物'),
(12, 2, 10, '迪士尼乐园童话世界，孩子最爱'),
(14, 2, 8, '植物园空气清新，适合亲子漫步'),

-- 商务人士推荐
(8, 3, 9, '上海中心观光高效便捷'),
(9, 3, 8, '金茂大厦交通便利'),
(5, 3, 9, '上海博物馆了解城市文化'),
(6, 3, 7, '人民广场交通枢纽便利'),

-- 老年游客推荐
(3, 4, 9, '豫园古典园林，安静舒适'),
(4, 4, 8, '城隍庙传统文化浓厚'),
(13, 4, 8, '静安寺佛教文化，环境幽静'),
(17, 4, 9, '鲁迅公园纪念意义深远'),

-- 学生群体推荐
(1, 5, 8, '外滩免费观光，性价比高'),
(2, 5, 8, '南京路步行街免费逛街'),
(5, 5, 9, '上海博物馆免费参观'),
(6, 5, 7, '人民广场免费活动区域'),

-- 摄影爱好者推荐
(1, 6, 10, '外滩万国建筑群绝佳拍摄地'),
(7, 6, 9, '东方明珠城市天际线'),
(28, 6, 9, '1933老场坊独特建筑风格'),
(22, 6, 8, '朱家角古镇江南水乡风情'),

-- 历史文化爱好者推荐
(3, 7, 10, '豫园明代古典园林'),
(4, 7, 9, '城隍庙道教文化'),
(5, 7, 10, '上海博物馆古代艺术'),
(21, 7, 9, '七宝古镇千年历史'),

-- 购物达人推荐
(2, 8, 10, '南京路中华商业第一街'),
(27, 8, 9, '新天地时尚购物中心'),
(26, 8, 8, '田子坊创意商品集中地'),
(3, 8, 7, '豫园商城传统商品'); 